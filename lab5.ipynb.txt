{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ú–µ–ª—å–±—É—Ä–Ω–∞\n",
    "## –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∏ –ø–æ–¥—Å—á–µ—Ç –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —Ä–∞–π–æ–Ω—É"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import glob\n",
    "import os\n",
    "from matplotlib.ticker import FuncFormatter\n",
    "\n",
    "# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è\n",
    "plt.style.use('seaborn-v0_8')\n",
    "sns.set_palette(\"husl\")\n",
    "plt.rcParams['figure.figsize'] = (12, 8)\n",
    "plt.rcParams['font.size'] = 12\n",
    "\n",
    "# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω\n",
    "def price_formatter(x, pos):\n",
    "    if x >= 1e6:\n",
    "        return f'${x/1e6:.1f}M'\n",
    "    else:\n",
    "        return f'${x/1e3:.0f}K'\n",
    "\n",
    "print(\"‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞...\")\n",
    "\n",
    "# –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ CSV —Ñ–∞–π–ª—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏\n",
    "csv_files = glob.glob('./housing_analysis_results/part-*.csv')\n",
    "print(f\"–ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {len(csv_files)}\")\n",
    "\n",
    "if not csv_files:\n",
    "    print(\"‚ùå –§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å:\")\n",
    "    print(\"   –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:\", os.getcwd())\n",
    "    print(\"   –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:\")\n",
    "    print(os.listdir('.'))\n",
    "else:\n",
    "    # –ß–∏—Ç–∞–µ–º –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ CSV —Ñ–∞–π–ª—ã\n",
    "    df_list = []\n",
    "    for file in csv_files:\n",
    "        temp_df = pd.read_csv(file)\n",
    "        df_list.append(temp_df)\n",
    "    \n",
    "    df = pd.concat(df_list, ignore_index=True)\n",
    "    \n",
    "    print(\"‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!\")\n",
    "    print(f\"üìä –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: {df.shape}\")\n",
    "    print(\"\\n–ü–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π:\")\n",
    "    display(df.head())\n",
    "    \n",
    "    print(\"\\nüìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö:\")\n",
    "    print(df.info())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üîß –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö...\")\n",
    "\n",
    "# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –æ—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ\n",
    "print(f\"–ò—Å—Ö–æ–¥–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π: {len(df)}\")\n",
    "\n",
    "# –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏\n",
    "df_clean = df.dropna()\n",
    "print(f\"–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤: {len(df_clean)}\")\n",
    "\n",
    "# –£–±–∏—Ä–∞–µ–º –≤—ã–±—Ä–æ—Å—ã (–≤–µ—Ä—Ö–Ω–∏–µ 2%)\n",
    "Q1 = df_clean['avg_price'].quantile(0.01)\n",
    "Q3 = df_clean['avg_price'].quantile(0.99)\n",
    "df_clean = df_clean[(df_clean['avg_price'] >= Q1) & (df_clean['avg_price'] <= Q3)]\n",
    "print(f\"–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤: {len(df_clean)}\")\n",
    "\n",
    "df = df_clean\n",
    "\n",
    "print(\"\\n‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üìà –û–°–ù–û–í–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ê–ù–ê–õ–ò–ó–ê\")\n",
    "print(\"=\" * 50)\n",
    "\n",
    "print(f\"üèôÔ∏è  –í—Å–µ–≥–æ —Ä–∞–π–æ–Ω–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: {len(df)}\")\n",
    "print(f\"üí∞ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ —Ä–∞–π–æ–Ω–∞–º: ${df['avg_price'].mean():,.2f}\")\n",
    "print(f\"üìä –ú–µ–¥–∏–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞: ${df['avg_price'].median():,.2f}\")\n",
    "print(f\"üè† –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤: {df['property_count'].sum():,}\")\n",
    "print(f\"üì¶ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Ä–∞–π–æ–Ω: {df['property_count'].mean():.1f}\")\n",
    "\n",
    "max_price_row = df.loc[df['avg_price'].idxmax()]\n",
    "min_price_row = df.loc[df['avg_price'].idxmin()]\n",
    "max_count_row = df.loc[df['property_count'].idxmax()]\n",
    "\n",
    "print(f\"\\nüèÜ –°–ê–ú–´–ô –î–û–†–û–ì–û–ô –†–ê–ô–û–ù:\")\n",
    "print(f\"   ‚Ä¢ {max_price_row['suburb']}\")\n",
    "print(f\"   ‚Ä¢ –¶–µ–Ω–∞: ${max_price_row['avg_price']:,.2f}\")\n",
    "print(f\"   ‚Ä¢ –û–±—ä–µ–∫—Ç–æ–≤: {max_price_row['property_count']}\")\n",
    "\n",
    "print(f\"\\nüí∏ –°–ê–ú–´–ô –î–û–°–¢–£–ü–ù–´–ô –†–ê–ô–û–ù:\")\n",
    "print(f\"   ‚Ä¢ {min_price_row['suburb']}\")\n",
    "print(f\"   ‚Ä¢ –¶–µ–Ω–∞: ${min_price_row['avg_price']:,.2f}\")\n",
    "print(f\"   ‚Ä¢ –û–±—ä–µ–∫—Ç–æ–≤: {min_price_row['property_count']}\")\n",
    "\n",
    "print(f\"\\nüèòÔ∏è  –†–ê–ô–û–ù –° –ù–ê–ò–ë–û–õ–¨–®–ò–ú –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï–ú:\")\n",
    "print(f\"   ‚Ä¢ {max_count_row['suburb']}\")\n",
    "print(f\"   ‚Ä¢ –û–±—ä–µ–∫—Ç–æ–≤: {max_count_row['property_count']}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: ${max_count_row['avg_price']:,.2f}\")\n",
    "\n",
    "print(f\"\\nüìê –î–ò–ê–ü–ê–ó–û–ù –¶–ï–ù:\")\n",
    "print(f\"   ‚Ä¢ –ú–∏–Ω–∏–º—É–º: ${df['avg_price'].min():,.2f}\")\n",
    "print(f\"   ‚Ä¢ –ú–∞–∫—Å–∏–º—É–º: ${df['avg_price'].max():,.2f}\")\n",
    "print(f\"   ‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: ${df['avg_price'].std():,.2f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è 1: –¢–æ–ø —Ä–∞–π–æ–Ω–æ–≤ –ø–æ —Ü–µ–Ω–µ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üìä –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø 1: –¢–û–ü –†–ê–ô–û–ù–û–í –ü–û –¶–ï–ù–ï\")\n",
    "print(\"=\" * 40)\n",
    "\n",
    "fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(20, 10))\n",
    "\n",
    "# –¢–æ–ø-15 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö —Ä–∞–π–æ–Ω–æ–≤\n",
    "top_15_expensive = df.nlargest(15, 'avg_price')\n",
    "bars1 = ax1.barh(top_15_expensive['suburb'], top_15_expensive['avg_price'], color='#ff6b6b')\n",
    "ax1.invert_yaxis()\n",
    "ax1.set_xlabel('–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ ($)')\n",
    "ax1.set_title('üèÜ –¢–û–ü-15 –°–ê–ú–´–• –î–û–†–û–ì–ò–• –†–ê–ô–û–ù–û–í', fontweight='bold', fontsize=14)\n",
    "ax1.xaxis.set_major_formatter(FuncFormatter(price_formatter))\n",
    "\n",
    "# –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã\n",
    "for bar, price, count in zip(bars1, top_15_expensive['avg_price'], top_15_expensive['property_count']):\n",
    "    ax1.text(bar.get_width() + 50000, bar.get_y() + bar.get_height()/2, \n",
    "             f'${price:,.0f}\\n({count} –æ–±—ä—è–≤.)', \n",
    "             va='center', fontsize=9, fontweight='bold')\n",
    "\n",
    "# –¢–æ–ø-15 —Å–∞–º—ã—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤\n",
    "top_15_affordable = df.nsmallest(15, 'avg_price')\n",
    "bars2 = ax2.barh(top_15_affordable['suburb'], top_15_affordable['avg_price'], color='#51cf66')\n",
    "ax2.invert_yaxis()\n",
    "ax2.set_xlabel('–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ ($)')\n",
    "ax2.set_title('üí∞ –¢–û–ü-15 –°–ê–ú–´–• –î–û–°–¢–£–ü–ù–´–• –†–ê–ô–û–ù–û–í', fontweight='bold', fontsize=14)\n",
    "ax2.xaxis.set_major_formatter(FuncFormatter(price_formatter))\n",
    "\n",
    "# –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã\n",
    "for bar, price, count in zip(bars2, top_15_affordable['avg_price'], top_15_affordable['property_count']):\n",
    "    ax2.text(bar.get_width() + 5000, bar.get_y() + bar.get_height()/2, \n",
    "             f'${price:,.0f}\\n({count} –æ–±—ä—è–≤.)', \n",
    "             va='center', fontsize=9, fontweight='bold')\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üìà –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø 2: –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ò –ö–û–†–†–ï–õ–Ø–¶–ò–ò\")\n",
    "print(\"=\" * 45)\n",
    "\n",
    "fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(18, 12))\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 1: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —Ü–µ–Ω\n",
    "ax1.hist(df['avg_price'], bins=25, edgecolor='black', alpha=0.7, color='#74c0fc')\n",
    "ax1.set_xlabel('–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ ($)')\n",
    "ax1.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤')\n",
    "ax1.set_title('üìä –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –°–†–ï–î–ù–ò–• –¶–ï–ù –ü–û –†–ê–ô–û–ù–ê–ú', fontweight='bold')\n",
    "ax1.xaxis.set_major_formatter(FuncFormatter(price_formatter))\n",
    "ax1.grid(True, alpha=0.3)\n",
    "\n",
    "# –î–æ–±–∞–≤–ª—è–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ –º–µ–¥–∏–∞–Ω—ã\n",
    "ax1.axvline(df['avg_price'].mean(), color='red', linestyle='--', label=f'–°—Ä–µ–¥–Ω–µ–µ: ${df[\"avg_price\"].mean():,.0f}')\n",
    "ax1.axvline(df['avg_price'].median(), color='green', linestyle='--', label=f'–ú–µ–¥–∏–∞–Ω–∞: ${df[\"avg_price\"].median():,.0f}')\n",
    "ax1.legend()\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 2: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤\n",
    "scatter = ax2.scatter(df['property_count'], df['avg_price'], alpha=0.6, s=60, c=df['avg_price'], cmap='viridis')\n",
    "ax2.set_xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–∞–π–æ–Ω–µ')\n",
    "ax2.set_ylabel('–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ ($)')\n",
    "ax2.set_title('üîó –ó–ê–í–ò–°–ò–ú–û–°–¢–¨: –¶–ï–ù–ê vs –ö–û–õ–ò–ß–ï–°–¢–í–û –û–ë–™–ï–ö–¢–û–í', fontweight='bold')\n",
    "ax2.yaxis.set_major_formatter(FuncFormatter(price_formatter))\n",
    "ax2.grid(True, alpha=0.3)\n",
    "\n",
    "# –î–æ–±–∞–≤–ª—è–µ–º —Ü–≤–µ—Ç–æ–≤—É—é —à–∫–∞–ª—É\n",
    "plt.colorbar(scatter, ax=ax2, label='–¶–µ–Ω–∞ ($)')\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 3: Boxplot —Ü–µ–Ω\n",
    "box_data = df[df['avg_price'] <= df['avg_price'].quantile(0.95)]\n",
    "ax3.boxplot(box_data['avg_price'], vert=False)\n",
    "ax3.set_xlabel('–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ ($)')\n",
    "ax3.set_title('üì¶ BOXPLOT –°–†–ï–î–ù–ò–• –¶–ï–ù (–±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤)', fontweight='bold')\n",
    "ax3.xaxis.set_major_formatter(FuncFormatter(price_formatter))\n",
    "ax3.set_yticks([1], ['–í—Å–µ —Ä–∞–π–æ–Ω—ã'])\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 4: –¢–æ–ø-10 –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ–±—ä–µ–∫—Ç–æ–≤\n",
    "top_10_volume = df.nlargest(10, 'property_count')\n",
    "bars = ax4.barh(top_10_volume['suburb'], top_10_volume['property_count'], color='#f783ac')\n",
    "ax4.invert_yaxis()\n",
    "ax4.set_xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤')\n",
    "ax4.set_title('üèòÔ∏è –¢–û–ü-10 –†–ê–ô–û–ù–û–í –ü–û –ö–û–õ–ò–ß–ï–°–¢–í–£ –û–ë–™–ï–ö–¢–û–í', fontweight='bold')\n",
    "\n",
    "for bar, count, price in zip(bars, top_10_volume['property_count'], top_10_volume['avg_price']):\n",
    "    ax4.text(bar.get_width() + 5, bar.get_y() + bar.get_height()/2, \n",
    "             f'{count} –æ–±—ä—è–≤.\\n(${price:,.0f})', \n",
    "             va='center', fontsize=9, fontweight='bold')\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üéØ –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø 3: –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ê–ù–ê–õ–ò–¢–ò–ö–ê\")\n",
    "print(\"=\" * 45)\n",
    "\n",
    "fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(20, 6))\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 1: –¶–µ–Ω–æ–≤—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã\n",
    "price_bins = [0, 500000, 800000, 1200000, float('inf')]\n",
    "price_labels = ['–î–æ $500K', '$500K-800K', '$800K-1.2M', '–í—ã—à–µ $1.2M']\n",
    "df['price_segment'] = pd.cut(df['avg_price'], bins=price_bins, labels=price_labels)\n",
    "segment_counts = df['price_segment'].value_counts()\n",
    "\n",
    "colors = ['#51cf66', '#ffd43b', '#ffa94d', '#ff6b6b']\n",
    "wedges, texts, autotexts = ax1.pie(segment_counts.values, labels=segment_counts.index, \n",
    "                                   autopct='%1.1f%%', colors=colors, startangle=90)\n",
    "ax1.set_title('üéØ –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –†–ê–ô–û–ù–û–í –ü–û –¶–ï–ù–û–í–´–ú –°–ï–ì–ú–ï–ù–¢–ê–ú', fontweight='bold', fontsize=12)\n",
    "\n",
    "# –£–ª—É—á—à–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤\n",
    "for autotext in autotexts:\n",
    "    autotext.set_color('white')\n",
    "    autotext.set_fontweight('bold')\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 2: –ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–Ω\n",
    "sns.kdeplot(df['avg_price'], fill=True, ax=ax2, color='#339af0')\n",
    "ax2.set_xlabel('–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ ($)')\n",
    "ax2.set_ylabel('–ü–ª–æ—Ç–Ω–æ—Å—Ç—å')\n",
    "ax2.set_title('üìà –ü–õ–û–¢–ù–û–°–¢–¨ –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –°–†–ï–î–ù–ò–• –¶–ï–ù', fontweight='bold')\n",
    "ax2.xaxis.set_major_formatter(FuncFormatter(price_formatter))\n",
    "ax2.grid(True, alpha=0.3)\n",
    "\n",
    "# –ì—Ä–∞—Ñ–∏–∫ 3: –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º\n",
    "segment_summary = df.groupby('price_segment').agg({\n",
    "    'suburb': 'count',\n",
    "    'avg_price': 'mean',\n",
    "    'property_count': 'sum'\n",
    "}).reset_index()\n",
    "\n",
    "x = range(len(segment_summary))\n",
    "width = 0.35\n",
    "\n",
    "bars1 = ax3.bar(x, segment_summary['suburb'], width, label='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤', color='#74c0fc')\n",
    "ax3.set_xlabel('–¶–µ–Ω–æ–≤—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã')\n",
    "ax3.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤')\n",
    "ax3.set_title('üìä –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –†–ê–ô–û–ù–û–í –ò –û–ë–™–ï–ö–¢–û–í –ü–û –°–ï–ì–ú–ï–ù–¢–ê–ú', fontweight='bold')\n",
    "ax3.set_xticks(x)\n",
    "ax3.set_xticklabels(segment_summary['price_segment'], rotation=45)\n",
    "\n",
    "# –í—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ —Ç–µ—Ö –∂–µ –æ—Å—è—Ö\n",
    "ax3_2 = ax3.twinx()\n",
    "bars2 = ax3_2.bar([i + width for i in x], segment_summary['property_count'], width, \n",
    "                  label='–í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤', color='#f783ac')\n",
    "ax3_2.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤')\n",
    "\n",
    "# –õ–µ–≥–µ–Ω–¥–∞\n",
    "lines1, labels1 = ax3.get_legend_handles_labels()\n",
    "lines2, labels2 = ax3_2.get_legend_handles_labels()\n",
    "ax3.legend(lines1 + lines2, labels1 + labels2, loc='upper left')\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –£–≥–ª—É–±–ª–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üîç –£–ì–õ–£–ë–õ–ï–ù–ù–´–ô –ê–ù–ê–õ–ò–ó –ò –ö–û–†–†–ï–õ–Ø–¶–ò–ò\")\n",
    "print(\"=\" * 45)\n",
    "\n",
    "# –†–∞—Å—á–µ—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏\n",
    "correlation = df[['avg_price', 'property_count']].corr().iloc[0,1]\n",
    "print(f\"üìä –ö–û–†–†–ï–õ–Ø–¶–ò–Ø –ú–ï–ñ–î–£ –¶–ï–ù–û–ô –ò –ö–û–õ–ò–ß–ï–°–¢–í–û–ú –û–ë–™–ï–ö–¢–û–í: {correlation:.3f}\")\n",
    "\n",
    "if correlation > 0.3:\n",
    "    print(\"   üìà –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å–ª–∞–±–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è\")\n",
    "elif correlation < -0.3:\n",
    "    print(\"   üìâ –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å–ª–∞–±–∞—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è\")\n",
    "else:\n",
    "    print(\"   ‚ûñ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç\")\n",
    "\n",
    "# –ê–Ω–∞–ª–∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Ä—ã–Ω–∫–∞\n",
    "luxury_threshold = df['avg_price'].quantile(0.75)  # –í–µ—Ä—Ö–Ω–∏–µ 25%\n",
    "affordable_threshold = df['avg_price'].quantile(0.25)  # –ù–∏–∂–Ω–∏–µ 25%\n",
    "\n",
    "luxury_suburbs = df[df['avg_price'] > luxury_threshold]\n",
    "affordable_suburbs = df[df['avg_price'] < affordable_threshold]\n",
    "mid_suburbs = df[(df['avg_price'] >= affordable_threshold) & (df['avg_price'] <= luxury_threshold)]\n",
    "\n",
    "print(f\"\\nüè∞ –ü–†–ï–ú–ò–£–ú-–°–ï–ì–ú–ï–ù–¢ (—Ü–µ–Ω—ã –≤—ã—à–µ ${luxury_threshold:,.0f}):\")\n",
    "print(f\"   ‚Ä¢ –†–∞–π–æ–Ω–æ–≤: {len(luxury_suburbs)}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: ${luxury_suburbs['avg_price'].mean():,.0f}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤: {luxury_suburbs['property_count'].mean():.1f}\")\n",
    "\n",
    "print(f\"\\nüè† –°–†–ï–î–ù–ò–ô –°–ï–ì–ú–ï–ù–¢:\")\n",
    "print(f\"   ‚Ä¢ –†–∞–π–æ–Ω–æ–≤: {len(mid_suburbs)}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: ${mid_suburbs['avg_price'].mean():,.0f}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤: {mid_suburbs['property_count'].mean():.1f}\")\n",
    "\n",
    "print(f\"\\nüí∏ –ë–Æ–î–ñ–ï–¢–ù–´–ô –°–ï–ì–ú–ï–ù–¢ (—Ü–µ–Ω—ã –Ω–∏–∂–µ ${affordable_threshold:,.0f}):\")\n",
    "print(f\"   ‚Ä¢ –†–∞–π–æ–Ω–æ–≤: {len(affordable_suburbs)}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: ${affordable_suburbs['avg_price'].mean():,.0f}\")\n",
    "print(f\"   ‚Ä¢ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤: {affordable_suburbs['property_count'].mean():.1f}\")\n",
    "\n",
    "# –ê–Ω–∞–ª–∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤\n",
    "balanced_suburbs = df[\n",
    "    (df['avg_price'] >= df['avg_price'].median() * 0.8) & \n",
    "    (df['avg_price'] <= df['avg_price'].median() * 1.2) &\n",
    "    (df['property_count'] >= df['property_count'].median())\n",
    "].nlargest(5, 'property_count')\n",
    "\n",
    "print(f\"\\n‚öñÔ∏è  –°–ê–ú–´–ï –°–ë–ê–õ–ê–ù–°–ò–†–û–í–ê–ù–ù–´–ï –†–ê–ô–û–ù–´ (–±–ª–∏–∑–∫–æ –∫ –º–µ–¥–∏–∞–Ω–µ —Ü–µ–Ω—ã, –≤—ã—Å–æ–∫–∏–π —Å–ø—Ä–æ—Å):\")\n",
    "for idx, row in balanced_suburbs.iterrows():\n",
    "    print(f\"   ‚Ä¢ {row['suburb']}: ${row['avg_price']:,.0f} ({row['property_count']} –æ–±—ä—è–≤.)\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –ë–∏–∑–Ω–µ—Å-–∏–Ω—Å–∞–π—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üéØ –ë–ò–ó–ù–ï–°-–ò–ù–°–ê–ô–¢–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò\")\n",
    "print(\"=\" * 50)\n",
    "print(\"\\nüìã –û–ë–©–ê–Ø –ö–ê–†–¢–ò–ù–ê –†–´–ù–ö–ê:\")\n",
    "print(f\"   ‚Ä¢ –ê–Ω–∞–ª–∏–∑ –æ—Ö–≤–∞—Ç–∏–ª {len(df)} —Ä–∞–π–æ–Ω–æ–≤ –ú–µ–ª—å–±—É—Ä–Ω–∞\")\n",
    "print(f\"   ‚Ä¢ –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤: {df['property_count'].sum():,}\")\n",
    "print(f\"   ‚Ä¢ –î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω: –æ—Ç ${df['avg_price'].min():,.0f} –¥–æ ${df['avg_price'].max():,.0f}\")\n",
    "\n",
    "print(\"\\nüí° –ö–õ–Æ–ß–ï–í–´–ï –ò–ù–°–ê–ô–¢–´:\")\n",
    "print(\"1. üìä –¶–ï–ù–û–í–ê–Ø –°–¢–†–ê–¢–ò–§–ò–ö–ê–¶–ò–Ø: –†—ã–Ω–æ–∫ —á–µ—Ç–∫–æ —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã\")\n",
    "print(\"2. üèòÔ∏è  –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï: –ù–∞–∏–±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –∏–º–µ—é—Ç —É–º–µ—Ä–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã\") \n",
    "print(\"3. üí∞ –¶–ï–ù–û–û–ë–†–ê–ó–û–í–ê–ù–ò–ï: –ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å\")\n",
    "print(\"4. üìà –î–û–°–¢–£–ü–ù–û–°–¢–¨: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å —Ä—ã–Ω–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ä–µ–¥–Ω–µ–º—É –∫–ª–∞—Å—Å—É\")\n",
    "\n",
    "print(\"\\nüéØ –°–¢–†–ê–¢–ï–ì–ò–ß–ï–°–ö–ò–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:\")\n",
    "print(\"   –î–õ–Ø –ò–ù–í–ï–°–¢–û–†–û–í:\")\n",
    "print(\"   ‚Ä¢ –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–π–æ–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ —Å —Ä–∞—Å—Ç—É—â–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ–±—ä–µ–∫—Ç–æ–≤\")\n",
    "print(\"   ‚Ä¢ –î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å –º–µ–∂–¥—É –ø—Ä–µ–º–∏—É–º –∏ —Å—Ä–µ–¥–Ω–∏–º —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏\")\n",
    "print(\"   ‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ä–∞–π–æ–Ω—ã —Å –≤—ã—Å–æ–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å—é (–º–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤)\")\n",
    "\n",
    "print(\"\\n   –î–õ–Ø –ü–û–ö–£–ü–ê–¢–ï–õ–ï–ô:\")\n",
    "print(\"   ‚Ä¢ –ò—Å–∫–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–µ–≥–º–µ–Ω—Ç–µ\")\n",
    "print(\"   ‚Ä¢ –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–∑–≤–∏–≤–∞—é—â–∏–µ—Å—è —Ä–∞–π–æ–Ω—ã —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏\")\n",
    "print(\"   ‚Ä¢ –û—Ü–µ–Ω–∏—Ç—å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã —Ä–æ—Å—Ç–∞ –≤ —Ä–∞–π–æ–Ω–∞—Ö —Å —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–º—Å—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º\")\n",
    "\n",
    "print(\"\\n   –î–õ–Ø –î–ï–í–ï–õ–û–ü–ï–†–û–í:\")\n",
    "print(\"   ‚Ä¢ –°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º —Ü–µ–Ω–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ - –Ω–∞–∏–±–æ–ª—å—à–∏–π —Å–ø—Ä–æ—Å\")\n",
    "print(\"   ‚Ä¢ –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ —Ä–∞–∑–≤–∏–≤–∞—é—â–∏—Ö—Å—è —Ä–∞–π–æ–Ω–∞—Ö\")\n",
    "print(\"   ‚Ä¢ –ò–∑—É—á–∏—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–µ–Ω–æ–≤–∞—Ü–∏–∏ –≤ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä–∞–π–æ–Ω–∞—Ö\")\n",
    "\n",
    "print(\"\\n   –î–õ–Ø –ê–ù–ê–õ–ò–¢–ò–ö–û–í:\")\n",
    "print(\"   ‚Ä¢ –£–≥–ª—É–±–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (—Ç–∏–ø—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏)\")\n",
    "print(\"   ‚Ä¢ –ò–∑—É—á–∏—Ç—å –¥–∏–Ω–∞–º–∏–∫—É —Ü–µ–Ω –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–∞–º\")\n",
    "print(\"   ‚Ä¢ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ\")\n",
    "\n",
    "print(f\"\\nüìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:\")\n",
    "print(f\"   –†—ã–Ω–æ–∫ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –ú–µ–ª—å–±—É—Ä–Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–¥–æ—Ä–æ–≤—É—é –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—é\")\n",
    "print(f\"   —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–∫—É–ø–∫–∏.\")\n",
    "print(f\"   –ù–∞–∏–±–æ–ª—å—à–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Ä–æ—Å—Ç–∞ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –≤ —Å—Ä–µ–¥–Ω–µ–º\")\n",
    "print(f\"   —Ü–µ–Ω–æ–≤–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ, —Å–æ—á–µ—Ç–∞—é—â–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(\"üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –ê–ù–ê–õ–ò–ó–ê\")\n",
    "print(\"=\" * 40)\n",
    "\n",
    "# –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n",
    "df_sorted = df.sort_values('avg_price', ascending=False)\n",
    "output_filename = 'melbourne_housing_analysis_final.csv'\n",
    "df_sorted.to_csv(output_filename, index=False)\n",
    "\n",
    "print(f\"‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {output_filename}\")\n",
    "\n",
    "# –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç\n",
    "summary_report = {\n",
    "    'total_suburbs': len(df),\n",
    "    'total_properties': df['property_count'].sum(),\n",
    "    'avg_price_overall': df['avg_price'].mean(),\n",
    "    'median_price': df['avg_price'].median(),\n",
    "    'min_price': df['avg_price'].min(),\n",
    "    'max_price': df['avg_price'].max(),\n",
    "    'price_std': df['avg_price'].std(),\n",
    "    'correlation_price_volume': df[['avg_price', 'property_count']].corr().iloc[0,1]\n",
    "}\n",
    "\n",
    "print(f\"\\nüìä –°–í–û–î–ù–´–ô –û–¢–ß–ï–¢:\")\n",
    "for key, value in summary_report.items():\n",
    "    if 'price' in key:\n",
    "        print(f\"   {key}: ${value:,.2f}\")\n",
    "    else:\n",
    "        print(f\"   {key}: {value}\")\n",
    "\n",
    "print(f\"\\nüéâ –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù!\")\n",
    "print(\"   –î–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ:\")\n",
    "print(\"   1. üìà –ì—Ä–∞—Ñ–∏–∫–∏ –∏–∑ —ç—Ç–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞\")\n",
    "print(\"   2. üìù –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏ –∏–Ω—Å–∞–π—Ç—ã\") \n",
    "print(\"   3. üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Å—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä–æ–≤\")\n",
    "print(\"   4. üìä –°–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤–∞—à–µ–º—É –≤–∞—Ä–∏–∞–Ω—Ç—É –∑–∞–¥–∞–Ω–∏—è\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}